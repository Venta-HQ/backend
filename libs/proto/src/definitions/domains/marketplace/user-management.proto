syntax = "proto3";

package marketplace.user_management;

import "shared/common.proto";

service UserManagementService {
  rpc HandleUserCreated (UserIdentityData) returns (shared.common.Empty) {}
  rpc HandleUserDeleted (UserIdentityData) returns (shared.common.Empty) {}
  // TODO: Get the real shape of subscription data
  rpc HandleSubscriptionCreated (CreateSubscriptionData) returns (CreateSubscriptionResponse) {}
  rpc GetUserVendors (shared.common.Empty) returns (VendorList) {}
}

// Service Function Types
message UserIdentityData {
    string id = 1;
}

enum SubscriptionProvider {
    SUBSCRIPTION_PROVIDER_UNSPECIFIED = 0;
    REVENUECAT = 1;
}

message CreateSubscriptionData {
    string clerkUserId = 1;
    SubscriptionProvider provider = 2;
    SubscriptionProviderData data = 3;
}

message CreateSubscriptionResponse {
    string message = 1;
}

message SubscriptionProviderData {
    string eventId = 1;
    string productId = 2;
    string transactionId = 3;
}

message VendorList {
    repeated UserVendor vendors = 1;
}

// Helper Types
message UserVendor {
    string id = 1;
    string name = 2;
}

// Note: Empty message now comes from shared/common.proto 